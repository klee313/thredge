# 댓글 수정 성능 개선 보고

## 개요
사용자로부터 댓글 수정 시 텍스트 영역 입력 반응이 매우 느리다는 제보를 접수했습니다. 이는 `localStorage` 동기화 및 상위 상태 업데이트 로직이 매 키 입력마다 발생하여 렌더링 성능을 저하시킨 것으로 파악되었습니다. 이에 `EntryComposer` 등에 적용된 디바운스(Debounce) 패턴을 `EntryEditor`에도 적용하여 성능을 개선했습니다.

## 문제 원인
1. **잦은 상태 업데이트**: `EntryEditor`가 `onChange`를 통해 상위 컴포넌트(`ThreadDetailPage`, `HomeFeed` 등)의 상태를 직접 업데이트함.
2. **비용이 큰 연산**: 상위 컴포넌트의 상태 변경이 `useEffect`를 통한 `localStorage` 동기화 로직(비록 `setTimeout`으로 디바운스 처리되어 있었으나, `useEffect` 자체는 매번 실행됨)과 전체 컴포넌트 트리 리렌더링을 유발.
3. **직접적인 제어**: `AutosizeTextarea`가 상위 상태에 직접 제어(Controlled)되어 있어, 상위 렌더링 지연이 입력 지연으로 직결됨.

## 개선 내용

### 1. `EntryEditor` 디바운스 적용
- `EntryEditor` 내부에 `localValue` 상태를 도입하여 입력 시 즉각적인 UI 반응을 보장했습니다.
- `useDebouncedValue` 훅을 사용하여 상위 컴포넌트로의 `onChange` 호출을 500ms 지연시켰습니다.
- 이를 통해 키 입력 시마다 발생하던 상위 컴포넌트 리렌더링 및 부수 효과를 획기적으로 줄였습니다.

### 2. 저장(Save) 로직 개선
- 디바운스로 인해 상위 컴포넌트의 상태가 최신 입력값보다 늦게 업데이트될 수 있는 문제가 발생했습니다.
- 이를 해결하기 위해 `onSave` 콜백이 현재 `localValue`를 인자로 받을 수 있도록 변경했습니다.
- `EntryCard`, `ThreadCard`, `ThreadDetailPage`, `HomeFeed` 등 관련 컴포넌트들이 `onEditSave(value)` 형태로 값을 전달받아, 상위 상태가 업데이트되기 전이라도 최신 값으로 저장 요청을 보낼 수 있도록 수정했습니다.

### 3. 관련 파일 수정
- `frontend/src/components/home/EntryEditor.tsx`: 로컬 상태 및 디바운스 로직 추가.
- `frontend/src/components/home/types.ts`: `EntryCardActions`, `ThreadCardActions` 타입 정의 수정.
- `frontend/src/components/home/EntryCard.tsx`, `ThreadCard.tsx`: 변경된 액션 타입 및 `EntryEditor` 사용 방식 적용.
- `frontend/src/routes/ThreadDetailPage.tsx`, `frontend/src/components/home/HomeFeed.tsx`: `onEditSave` 구현부 수정 (인자 처리).

## 검증
- 변경 후 `frontend` 빌드를 수행하여 타입 오류 및 빌드 문제가 없음을 확인했습니다.
- `ComponentLabPage` 등의 관련 없는 오류도 수정하여 클린 빌드를 확보했습니다.

## 향후 계획
- 다른 입력 폼에서도 유사한 성능 문제가 발견될 경우 동일한 패턴(Local State + Debounce)을 적용할 것을 권장합니다.
