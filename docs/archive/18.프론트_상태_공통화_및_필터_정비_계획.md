# 프론트 상태 공통화 및 필터 정비 계획

## 배경/문제
- 홈/상세 화면에서 상태 관리 훅 로직이 유사하게 중복되어 유지보수 비용이 증가한다.
- 목록 API에 페이지 파라미터를 전달하지 않아 클라이언트가 부분 데이터만 기준으로 날짜/카테고리 필터 및 카운트를 계산한다.

## 목표
- 홈/상세 화면의 상태 관리 로직을 공통화하여 중복과 동기화 오류 가능성을 줄인다.
- 목록 API 호출 시 페이지 파라미터를 명시하고, 필터/카운트가 기대 동작과 어긋나지 않도록 정비한다.

## 범위
- 포함 범위
  - 홈/상세 상태 관리 훅 공통화(공유 훅/유틸/리듀서 형태 중 선택)
  - 쓰레드/엔트리 목록 API 호출 시 페이지 파라미터 전달
  - 페이지네이션 UI(Load more 등) 적용
  - 카테고리별 전체 카운트 조회 API 추가 및 연동
  - 필터/카운트 계산 방식 재정의 및 UI 반영
- 제외 범위
  - 서버 응답 포맷 변경
  - 페이지네이션 UI 대규모 재설계

## 현재 동작 정리
- `useHomeFeedState`와 `useThreadDetailState`가 유사한 상태(편집/답글/카테고리 입력 등)를 각각 보유한다.
- 홈 화면에서 날짜/카테고리 필터 및 카운트를 클라이언트가 계산하며, 기본 페이지 크기 기준으로만 집계된다.
- 목록 API는 서버에서 페이지 응답을 반환하나 프론트는 페이지 파라미터를 전달하지 않는다.

## 개선 방향
- 상태 관리 구조를 공통화하되, 홈/상세 화면별 고유 상태는 얇은 래퍼로 분리한다.
- 필터/카운트는 현재 전달되는 데이터 범위를 명확히 반영하도록 정리한다.
- 페이지 파라미터는 기본값을 명시해 호출 의도를 분명히 한다.
- 페이지네이션 UI는 단순한 Load more 형태로 우선 도입한다.

## 단계별 계획
- Step 1: 상태 공통화 설계
  - 중복 상태/액션 목록을 정리하고 공통 훅 또는 리듀서 형태를 결정한다.
  - 완료 기준: 공통 훅 인터페이스가 문서화되고 적용 위치가 정해짐.
- Step 2: 홈/상세 상태 훅 리팩터링
  - 공통 훅 적용 후 각 화면에 필요한 상태만 래핑한다.
  - 완료 기준: 중복 상태/액션 코드가 제거되고 동작 동일.
- Step 3: 목록 API 호출 파라미터 및 페이지네이션 적용
  - 기본 `page/size`를 명시적으로 전달한다.
  - 화면별 Load more 동작을 추가한다.
  - 완료 기준: 페이지 단위로 데이터를 불러오고 추가 로드가 가능함.
- Step 4: 필터/카운트 정리
  - 클라이언트 계산의 의미를 UI 문구 또는 로직으로 정리한다.
  - 완료 기준: 필터/카운트가 데이터 범위에 맞게 동작하며 혼란을 줄임.
- Step 5: 카테고리 전체 카운트 API 연동
  - 서버에서 카테고리별 전체 카운트를 반환한다.
  - 홈 화면 카테고리 카운트에 적용한다.
  - 완료 기준: 전체 기준 카운트가 안정적으로 표시됨.

## 리스크 및 대응
- 상태 공통화 과정에서 화면별 동작이 미묘하게 달라질 수 있다.
  - 대응: 단계별 리팩터링 후 화면별 수동 점검을 수행한다.
- 필터/카운트 의미 변경이 UX 혼란을 줄 수 있다.
  - 대응: UI 문구/라벨로 범위를 명확히 알리고 변경 사항을 최소화한다.
- 페이지네이션 도입으로 일부 데이터만 보이는 상태가 생길 수 있다.
  - 대응: Load more 버튼 노출과 로딩 상태를 명확히 표시한다.
- 카운트 API 추가로 응답 일관성 문제가 생길 수 있다.
  - 대응: 동일 owner 기준으로 카운트를 계산하고 경계 케이스를 테스트한다.

## 검증 계획
- 홈 화면에서 작성/편집/답글 흐름이 기존과 동일한지 수동 확인
- 상세 화면에서 쓰레드/엔트리 편집 및 답글 흐름 수동 확인
- 카테고리 필터 및 카운트가 예상 데이터 범위로 표시되는지 확인
- Load more 동작으로 추가 로드가 정상인지 확인
- 카테고리 전체 카운트 표시가 실제 데이터와 일치하는지 확인
