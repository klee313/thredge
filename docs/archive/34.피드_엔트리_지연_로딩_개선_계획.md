# 피드_엔트리_지연_로딩_개선_계획

## 배경/문제
- 현재 feed API가 ThreadDetail에 entries까지 포함하여 응답함
- 카테고리 필터 시 스레드 수와 엔트리 수가 많아지면 응답 지연이 커짐
- 사용자는 스레드 목록 먼저 렌더링하고, 이후에 엔트리를 별도 호출로 불러오는 방향을 원함

## 목표
- feed 응답에서 엔트리 로딩을 분리하여 초기 렌더링 속도 개선
- 엔트리 조회를 별도 API로 제공해 필요한 시점에만 로드
- 기능 변경에 따른 응답 형식 및 클라이언트 동작을 명확히 정의

## 범위
- 포함 범위
  - feed API에서 entries 제외 (응답 경량화)
  - 스레드별 엔트리 목록을 조회하는 별도 API 설계/구현
  - 프론트엔드에서 피드 렌더링 후 엔트리 지연 로딩 구현
  - 엔트리 조회 페이징/정렬/숨김 처리 정책 정리
- 제외 범위
  - 캐시 레이어 신규 도입

## 현재 동작 정리
- `/api/threads/feed`가 ThreadDetail을 반환하며 entries가 포함됨
- 서버에서 threads 조회 후 entries를 한 번에 조회해 매핑
- 엔트리 수가 많은 스레드가 포함되면 응답 페이로드와 처리 시간이 증가

## 개선 방향
- 초기 피드 응답은 ThreadSummary 또는 entries 제외 옵션으로 경량화
- 엔트리는 별도 API를 통해 필요 시 조회
- 데이터 정합성(숨김, 정렬, 페이징) 규칙을 명확히 정의

## 단계별 계획
- Step 1: API 설계 결정
  - 무엇을 변경: feed 응답 형태(요약 vs 옵션), 엔트리 조회 API 경로/파라미터 정의
  - 완료 기준: 요청/응답 스키마 문서화
- Step 2: 백엔드 구현
  - 무엇을 변경: feed 응답 경량화 로직 추가, 엔트리 조회 API 구현
  - 완료 기준: 기능 동작 확인 및 기본 테스트 통과
- Step 3: 성능 검증
  - 무엇을 변경: 변경 전/후 응답 시간 및 페이로드 비교
  - 완료 기준: 개선 수치 정리
- Step 4: 프론트엔드 구현
  - 무엇을 변경: HomeFeed에서 ThreadFeedItem 사용, ThreadCard에서 엔트리 지연 로딩 구현
  - 완료 기준: 피드 렌더링 후 엔트리가 별도 API로 로딩되어 표시됨

## 리스크 및 대응
- 응답 형식 변경으로 클라이언트 호환성 이슈
  - 대응: 옵션 플래그 제공 또는 신규 엔드포인트로 분리
- 엔트리 조회 추가 호출로 서버 호출 수 증가
  - 대응: 필요 시 페이징/요약 응답 제공

## 검증 계획
- 동일 카테고리 기준 feed 응답 시간 비교
- 엔트리 조회 API의 정렬/숨김/페이징 동작 확인
- 기존 기능 회귀 확인(스레드 목록 정합성)
