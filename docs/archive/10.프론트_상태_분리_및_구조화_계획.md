# 프론트 상태 분리 및 구조화 계획

## 배경/문제
- HomeFeed/ThreadDetailPage에서 로컬 상태가 많아 컴포넌트가 길고 역할이 분산된다.
- ThreadCard의 props가 커져 읽기와 유지보수가 어렵다.
- useThreadActions 옵션이 느슨해져 실수 가능성이 있다.
- EntryCard 내부에 에디터/답글 로직이 함께 있어 재사용과 테스트가 어려워진다.

## 목표
- 페이지/컴포넌트의 상태를 훅으로 묶어 관심사를 분리한다.
- ThreadCard props를 도메인별로 묶어 전달 구조를 명확히 한다.
- useThreadActions 옵션을 구조화해 안정성을 높인다.
- EntryCard 내부 로직을 서브 컴포넌트로 분리한다.

## 범위
- 포함: `frontend/src/components/home/HomeFeed.tsx`, `frontend/src/routes/ThreadDetailPage.tsx`, `frontend/src/components/home/ThreadCard.tsx`, `frontend/src/components/home/EntryCard.tsx`, `frontend/src/hooks/useThreadActions.ts`
- 포함: 상태 훅/서브 컴포넌트 신규 파일 추가
- 제외: 디자인 변경, 기능 추가, API 변경, 테스트 프레임워크 추가

## 현재 동작 정리
- HomeFeed/ThreadDetailPage가 여러 UI 상태를 직접 관리한다.
- ThreadCard의 props가 많은 플랫 구조로 전달된다.
- useThreadActions에 invalidate 옵션이 자유롭게 추가되는 구조다.
- EntryCard가 편집/답글 UI와 로직을 모두 포함한다.

## 개선 방향
- HomeFeed/ThreadDetail 상태는 전용 훅으로 이동해 컴포넌트는 렌더링 위주로 유지한다.
- ThreadCard props를 `data`, `actions`, `ui` 그룹으로 나눈다.
- useThreadActions 옵션을 고정 타입(예: `InvalidateTarget` 배열)으로 단순화한다.
- EntryCard 내부를 `EntryEditor`, `ReplyComposer`로 분리한다.

## 단계별 계획
- 단계 1: HomeFeed 상태 훅 분리
  - 변경: HomeFeed 내 state/핸들러를 `useHomeFeedState`로 이동
  - 완료 기준: HomeFeed는 훅 결과를 받아 렌더링만 수행
- 단계 2: ThreadDetail 상태 훅 분리
  - 변경: ThreadDetail 내 state/핸들러를 `useThreadDetailState`로 이동
  - 완료 기준: ThreadDetail은 상태 훅 중심으로 구성
- 단계 3: ThreadCard props 구조화
  - 변경: `ThreadCardProps`를 `data`, `actions`, `ui`로 분리
  - 완료 기준: 전달 구조가 명확하고 코드가 간결함
- 단계 4: useThreadActions 옵션 구조화
  - 변경: invalidate 옵션을 enum/배열 기반으로 단순화
  - 완료 기준: 훅 사용법 일관성 확보
- 단계 5: EntryCard 서브 컴포넌트 분리
  - 변경: EntryEditor/ReplyComposer 컴포넌트 추가
  - 완료 기준: EntryCard가 렌더링 조합 역할만 유지

## 리스크 및 대응
- 리스크: 훅 분리로 props/의존 관계가 복잡해질 수 있음
  - 대응: 반환 구조를 그룹화하고 필요 값만 노출
- 리스크: 기존 핸들러 분기 로직 누락
  - 대응: 단계별로 작은 변경 후 수동 검증

## 검증 계획
- 수동 검증
  - Home: 스레드 작성/편집/핀/숨김, 검색/필터, 카테고리 추가/삭제, 답글
  - ThreadDetail: 스레드 수정/핀/숨김, 엔트리 편집/답글
- 간단 확인
  - 콘솔 에러 없음
  - 주요 네비게이션 정상
