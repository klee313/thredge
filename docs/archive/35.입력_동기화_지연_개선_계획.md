# 입력 동기화 지연 개선 계획

## 배경/문제
- 일부 입력 영역에서 작성한 텍스트가 localStorage 및 API 전송에 늦게 반영된다.
- 특히 댓글/답글 작성 시 제출 직후 이전 텍스트가 전송되거나 저장 값이 어긋나는 사례가 있다.

## 목표
- 모든 textarea/input에서 제출 시점에 최신 입력값이 API로 전송된다.
- 전송 실패 시에도 마지막 제출 시도 텍스트가 localStorage에 유지된다.

## 범위
- 포함 범위
  - 홈 피드 새 스레드 작성
  - 스레드 상세 댓글/답글 작성
  - 기타 입력 컴포저(텍스트/카테고리 등) 중 제출 시점 동기화가 필요한 곳
- 제외 범위
  - 서버 API 동작 변경
  - 입력 UI 레이아웃/스타일 변경

## 현재 동작 정리
- 일부 컴포저는 내부 로컬 상태를 사용하고, 상위 상태로는 디바운스된 값을 전달한다.
- 제출 로직이 상위 상태 값을 사용하는 경우, 최신 입력이 반영되기 전에 전송이 발생할 수 있다.

## 개선 방향
- 제출 시점에는 반드시 로컬 입력값을 직접 사용하거나 즉시 상위 상태로 동기화한다.
- localStorage는 상위 상태를 기준으로 저장하되, 제출 직전 동기화를 통해 최신값을 보장한다.

## 단계별 계획
- Step 1: 모든 입력 컴포저/폼에서 로컬 상태와 제출 경로를 조사한다.
  - 완료 기준: 제출 시점에 상위 상태 값을 사용하고 있는 후보 목록 확보
- Step 2: 제출 시점 최신값 사용 방식으로 통일한다.
  - 방법: onSubmit에 최신 값을 전달하거나, 제출 직전 상위 상태를 동기화
  - 완료 기준: 모든 해당 컴포저에서 최신값이 API 전송에 반영됨
- Step 3: 전송 실패 시 로컬/스토리지 값 유지 여부 확인 및 보완
  - 완료 기준: 실패 시점에 마지막 제출 텍스트가 localStorage에 유지됨

## 리스크 및 대응
- 리스크: 로컬/상위 상태 동기화 타이밍 변경으로 인해 UI가 순간적으로 재렌더될 수 있음
- 대응: 제출 직전에만 동기화하여 평상시 입력 경험은 유지

## 검증 계획
- 새 스레드 작성 후 즉시 제출: 마지막 타이핑이 그대로 전송되는지 확인
- 댓글/답글 작성 후 즉시 제출: 마지막 타이핑이 그대로 전송되는지 확인
- 의도적으로 전송 실패 유도 후: localStorage에 마지막 제출 텍스트가 유지되는지 확인
